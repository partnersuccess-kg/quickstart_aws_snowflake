{"job":{"components":{"8152736":{"id":8152736,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":479,"y":29,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[8152734],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_POSITION"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_POSITION"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRADER"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SYMBOL"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"sum_INVESTMENT"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"sum_SHARESBOUGHT"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"sum_RETURN"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"sum_SHARESSOLD"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"NET_SHARES"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"NET_VALUE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_PRICE"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"8152737":{"id":8152737,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":146,"y":155,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[8152732],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STOCK_HISTORY"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STOCK_HISTORY"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SYMBOL"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"DATE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"OPEN"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"HIGH"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"LOW"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"CLOSE"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"VOLUME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"ADJCLOSE"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ZEPL_US_STOCKS_DAILY"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"8152740":{"id":8152740,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-319648201,"x":1029,"y":43,"width":32,"height":32,"inputConnectorIDs":[8152728],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRADER_PNL_TOTAL_VIEW"}}}},"visible":true},"2":{"slot":2,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"3":{"slot":3,"name":"View Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRADER_PNL_TOTAL_VIEW"}}}},"visible":true},"5":{"slot":5,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Secure View","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"7":{"slot":7,"name":"View Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"8152741":{"id":8152741,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":478,"y":159,"width":32,"height":32,"inputConnectorIDs":[8152734,8152735],"outputConnectorIDs":[8152738],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join CURRENT_POSITION and STOCK_HISTORY"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_POSITION"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"current_position"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FILTER ON YEST DATE"},"2":{"slot":2,"type":"STRING","value":"stock_history"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"current_position\".\"SYMBOL\" = \"stock_history\".\"SYMBOL\""},"2":{"slot":2,"type":"STRING","value":"current_position_Left_stock_history"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"current_position.TRADER"},"2":{"slot":2,"type":"STRING","value":"TRADER"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"current_position.SYMBOL"},"2":{"slot":2,"type":"STRING","value":"current_position_SYMBOL"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"current_position.sum_INVESTMENT"},"2":{"slot":2,"type":"STRING","value":"sum_INVESTMENT"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"current_position.sum_SHARESBOUGHT"},"2":{"slot":2,"type":"STRING","value":"sum_SHARESBOUGHT"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"current_position.sum_RETURN"},"2":{"slot":2,"type":"STRING","value":"sum_RETURN"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"current_position.sum_SHARESSOLD"},"2":{"slot":2,"type":"STRING","value":"sum_SHARESSOLD"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"current_position.NET_SHARES"},"2":{"slot":2,"type":"STRING","value":"NET_SHARES"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"current_position.NET_VALUE"},"2":{"slot":2,"type":"STRING","value":"NET_VALUE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"current_position.AVG_PRICE"},"2":{"slot":2,"type":"STRING","value":"AVG_PRICE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"stock_history.CLOSE"},"2":{"slot":2,"type":"STRING","value":"CLOSE"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"8152742":{"id":8152742,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":288,"y":160,"width":32,"height":32,"inputConnectorIDs":[8152732],"outputConnectorIDs":[8152735],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FILTER ON YEST DATE"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DATE"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"${yest_date.now().add(\"days\", -1).format(\"yyyy-MM-dd\")}"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"8152743":{"id":8152743,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":688,"y":155,"width":32,"height":32,"inputConnectorIDs":[8152738],"outputConnectorIDs":[8152733,8152739],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GAINS"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"(\"NET_SHARES\" * \"CLOSE\") - (\"NET_SHARES\" * \"AVG_PRICE\")"},"2":{"slot":2,"type":"STRING","value":"UNREAL_GAINS"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"NET_SHARES\" = 0 THEN \"NET_VALUE\" ELSE \"sum_INVESTMENT\" - (\"sum_SHARESSOLD\" * \"AVG_PRICE\") END"},"2":{"slot":2,"type":"STRING","value":"REAL_GAINS"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"8152746":{"id":8152746,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1701703136,"x":875,"y":42,"width":32,"height":32,"inputConnectorIDs":[8152733],"outputConnectorIDs":[8152728],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SUM GAINS PER TRADER"}}}},"visible":true},"2":{"slot":2,"name":"Groupings","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRADER"}}}},"visible":true},"3":{"slot":3,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UNREAL_GAINS"},"2":{"slot":2,"type":"STRING","value":"Sum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"REAL_GAINS"},"2":{"slot":2,"type":"STRING","value":"Sum"}}}},"visible":true},"4":{"slot":4,"name":"Grouping Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Group By"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"8152747":{"id":8152747,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":884,"y":163,"width":32,"height":32,"inputConnectorIDs":[8152739],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRADER_PNL_TODAY"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRADER_PNL_TODAY"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"8":{"slot":8,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"9":{"slot":9,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"8152728":{"id":8152728,"sourceID":8152746,"targetID":8152740},"8152732":{"id":8152732,"sourceID":8152737,"targetID":8152742},"8152733":{"id":8152733,"sourceID":8152743,"targetID":8152746},"8152734":{"id":8152734,"sourceID":8152736,"targetID":8152741},"8152735":{"id":8152735,"sourceID":8152742,"targetID":8152741},"8152738":{"id":8152738,"sourceID":8152741,"targetID":8152743},"8152739":{"id":8152739,"sourceID":8152743,"targetID":8152747}},"notes":{},"noteConnectors":{},"variables":{"yest_date":{"definition":{"name":"yest_date","type":"DATETIME","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"1900-01-01"}},"grids":{}},"info":{"name":"TraderPnL_Transformation2","description":"","type":"TRANSFORMATION","tag":"de0ea4a9-403e-48a7-b1b2-d46e75bb4bfc"}}